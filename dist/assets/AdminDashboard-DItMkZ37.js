var pe=Object.defineProperty;var be=(o,t,a)=>t in o?pe(o,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[t]=a;var q=(o,t,a)=>be(o,typeof t!="symbol"?t+"":t,a);import{r as c,j as e}from"./index-BNPBOLjl.js";import{C as ve}from"./customerAccount-DlY9TAA7.js";const fe={id:"admin_001",username:"vip_admin",email:"admin@vipcleaningsquad.ca",role:"super_admin",permissions:["view_transactions","manage_bookings","manage_customers","system_settings"],lastLogin:new Date().toISOString(),isActive:!0,createdAt:"2024-01-01T00:00:00Z"},P=class P{constructor(){q(this,"currentSession",null)}static getInstance(){return P.instance||(P.instance=new P),P.instance}async login(t,a){try{if(t==="vip_admin"&&a==="VIPClean2024!"){const s={token:`admin_token_${Date.now()}_${Math.random().toString(36).substring(2)}`,admin:fe,expiresAt:new Date(Date.now()+288e5).toISOString()};return this.currentSession=s,localStorage.setItem("vip_admin_session",JSON.stringify(s)),s}return null}catch(s){return console.error("Admin login error:",s),null}}async logout(){this.currentSession=null,localStorage.removeItem("vip_admin_session")}getCurrentSession(){if(this.currentSession)return this.currentSession;const t=localStorage.getItem("vip_admin_session");if(t)try{const a=JSON.parse(t);if(new Date(a.expiresAt)>new Date)return this.currentSession=a,a;localStorage.removeItem("vip_admin_session")}catch{localStorage.removeItem("vip_admin_session")}return null}isAuthenticated(){return this.getCurrentSession()!==null}hasPermission(t){const a=this.getCurrentSession();return(a==null?void 0:a.admin.permissions.includes(t))||!1}};q(P,"instance");let K=P;class ie{getStoredTransactions(){try{const t=localStorage.getItem("vip_admin_transactions");return t?JSON.parse(t):[]}catch{return[]}}getStoredBookings(){try{const t=localStorage.getItem("vip_admin_bookings");return t?JSON.parse(t):[]}catch{return[]}}async getTransactions(){return this.getStoredTransactions()}async getBookings(){return this.getStoredBookings()}async updateBookingStatus(t,a){return console.log(`Updating booking ${t} status to ${a}`),!0}async updateBookingTeam(t,a){return console.log(`Assigning booking ${t} to ${a}`),!0}async addBookingNote(t,a){return console.log(`Adding note to booking ${t}: ${a}`),!0}async refundTransaction(t){return console.log(`Processing refund for transaction ${t}`),!0}}const E=class E{static getInstance(){return E.instance||(E.instance=new E),E.instance}getBusinessMetrics(){const t=this.getStoredTransactions(),a=this.getStoredBookings(),s=this.getStoredCustomers();return{totalRevenue:this.calculateTotalRevenue(t),monthlyRevenue:this.calculatePeriodRevenue(t,"month"),weeklyRevenue:this.calculatePeriodRevenue(t,"week"),dailyRevenue:this.calculatePeriodRevenue(t,"day"),revenueGrowth:this.calculateRevenueGrowth(t),revenueByService:this.calculateRevenueByService(t),averageOrderValue:this.calculateAverageOrderValue(t),totalCustomers:s.length,newCustomers:this.calculateNewCustomers(s),returningCustomers:this.calculateReturningCustomers(s,a),customerRetentionRate:this.calculateRetentionRate(s,a),customerLifetimeValue:this.calculateAverageCustomerLifetimeValue(s,t),churnRate:this.calculateChurnRate(s,a),totalBookings:a.length,completedBookings:a.filter(n=>n.status==="completed").length,pendingBookings:a.filter(n=>n.status==="scheduled").length,cancelledBookings:a.filter(n=>n.status==="cancelled").length,bookingConversionRate:this.calculateConversionRate(a),averageServiceTime:this.calculateAverageServiceTime(a),serviceAreaPerformance:this.analyzeServiceAreas(a,t),topPerformingAreas:this.getTopPerformingAreas(a,t),expansionOpportunities:this.identifyExpansionOpportunities(a),demandForecast:this.generateDemandForecast(a,t),seasonalTrends:this.analyzeSeasonalTrends(a),recommendedActions:this.generateBusinessRecommendations(t,a,s)}}getCustomerInsights(){const t=this.getStoredCustomers(),a=this.getStoredBookings(),s=this.getStoredTransactions();return t.map(n=>{const l=a.filter(u=>u.customerEmail===n.email),i=s.filter(u=>u.customerEmail===n.email);return{id:n.id,email:n.email,lifetimeValue:this.calculateCustomerLifetimeValue(n,i),totalBookings:l.length,averageOrderValue:this.calculateCustomerAverageOrderValue(i),lastServiceDate:this.getLastServiceDate(l),nextPredictedBooking:this.predictNextBooking(l),churnRisk:this.assessChurnRisk(n,l),preferredServices:this.getPreferredServices(l),satisfactionScore:this.calculateSatisfactionScore(l),referralPotential:this.assessReferralPotential(n,l),recommendations:this.generateCustomerRecommendations(n,l)}})}getPerformanceAlerts(){const t=this.getBusinessMetrics(),a=[];return t.revenueGrowth.monthly<-10&&a.push({id:`alert_${Date.now()}_revenue`,type:"warning",category:"Revenue",title:"Monthly Revenue Decline",message:`Revenue decreased by ${Math.abs(t.revenueGrowth.monthly).toFixed(1)}% this month`,value:t.revenueGrowth.monthly,threshold:-10,trend:"down",actionRequired:!0,suggestions:["Review pricing strategy","Increase marketing efforts"],createdAt:new Date().toISOString()}),a}getRevenueTrends(t="month"){this.getStoredTransactions(),this.getStoredBookings();const a=[];for(let s=0;s<12;s++){const n=new Date;n.setMonth(n.getMonth()-s),a.push({date:n.toISOString().split("T")[0],revenue:Math.random()*1e3,bookings:Math.floor(Math.random()*10)})}return a.reverse()}getStoredTransactions(){try{const t=localStorage.getItem("vip_admin_transactions");return t?JSON.parse(t):[]}catch{return[]}}getStoredBookings(){try{const t=localStorage.getItem("vip_admin_bookings");return t?JSON.parse(t):[]}catch{return[]}}getStoredCustomers(){try{const t=localStorage.getItem("vip_customers");return t?JSON.parse(t):[]}catch{return[]}}calculateTotalRevenue(t){return t.filter(a=>a.status==="completed").reduce((a,s)=>a+s.amount,0)}calculatePeriodRevenue(t,a){return t.reduce((s,n)=>s+n.amount,0)}calculateRevenueGrowth(t){return{monthly:5.2,weekly:2.1,daily:.3}}calculateRevenueByService(t){return t.filter(a=>a.status==="completed").reduce((a,s)=>(s.serviceType==="residential"?a.residential+=s.amount:a.commercial+=s.amount,a),{residential:0,commercial:0})}calculateAverageOrderValue(t){const a=t.filter(s=>s.status==="completed");return a.length>0?a.reduce((s,n)=>s+n.amount,0)/a.length:0}calculateNewCustomers(t){return Math.floor(t.length*.2)}calculateReturningCustomers(t,a){return t.filter(s=>a.filter(l=>l.customerEmail===s.email).length>1).length}calculateRetentionRate(t,a){const s=t.length,n=this.calculateReturningCustomers(t,a);return s>0?n/s*100:0}calculateAverageCustomerLifetimeValue(t,a){const s=t.map(n=>this.calculateCustomerLifetimeValue(n,a));return s.length>0?s.reduce((n,l)=>n+l,0)/s.length:0}calculateCustomerLifetimeValue(t,a){return a.filter(n=>n.customerEmail===t.email&&n.status==="completed").reduce((n,l)=>n+l.amount,0)}calculateChurnRate(t,a){return Math.random()*20}calculateConversionRate(t){const a=t.filter(n=>n.status==="completed").length,s=t.length;return s>0?a/s*100:75}calculateAverageServiceTime(t){return 2.5}analyzeServiceAreas(t,a){return[...new Set(t.map(n=>n.serviceArea))].map(n=>({area:n,totalBookings:t.filter(l=>l.serviceArea===n).length,totalRevenue:a.filter(l=>l.serviceArea===n).reduce((l,i)=>l+i.amount,0),averageOrderValue:150,customerSatisfaction:4.5,marketPenetration:Math.random()*30+10,growthPotential:Math.random()*40+20}))}getTopPerformingAreas(t,a){return["St. Catharines","Niagara Falls","Welland"]}identifyExpansionOpportunities(t){return["Beamsville","Jordan","Vineland"]}generateDemandForecast(t,a){const s=[];for(let n=1;n<=12;n++){const l=new Date;l.setDate(l.getDate()+n*7),s.push({date:l.toISOString().split("T")[0],predictedBookings:Math.floor(Math.random()*20)+5,predictedRevenue:Math.random()*2e3+500,confidence:Math.max(.5,.9-n*.05),factors:["Spring cleaning season"]})}return s}analyzeSeasonalTrends(t){return[{period:"Spring (Mar-May)",pattern:"high",demandMultiplier:1.3,popularServices:["Deep Cleaning","Move-in Cleaning"],recommendations:["Increase capacity","Promote spring cleaning packages"]},{period:"Summer (Jun-Aug)",pattern:"medium",demandMultiplier:1,popularServices:["Standard Cleaning","Commercial Cleaning"],recommendations:["Focus on recurring clients","Expand commercial services"]}]}generateBusinessRecommendations(t,a,s){return[{category:"revenue",priority:"high",title:"Increase Average Order Value",description:"Current AOV is below industry average.",potentialImpact:"+25-40% revenue increase",actionItems:["Introduce premium service packages","Offer add-on services"],timeline:"2-4 weeks",expectedRoi:35}]}calculateCustomerAverageOrderValue(t){return this.calculateAverageOrderValue(t)}getLastServiceDate(t){const a=t.filter(s=>s.status==="completed").sort((s,n)=>new Date(n.serviceDate).getTime()-new Date(s.serviceDate).getTime());return a.length>0?a[0].serviceDate:"Never"}predictNextBooking(t){return"Unknown"}assessChurnRisk(t,a){return a.length>3?"low":a.length>1?"medium":"high"}getPreferredServices(t){const a={};for(const s of t){const n=s.cleaningType||s.serviceType||"standard";a[n]=(a[n]||0)+1}return Object.entries(a).sort(([,s],[,n])=>n-s).slice(0,3).map(([s])=>s)}calculateSatisfactionScore(t){return t.length>0?4.2+Math.random()*.8:0}assessReferralPotential(t,a){return Math.min(10,a.length*.5+4.5)}generateCustomerRecommendations(t,a){const s=[];return a.length>3&&s.push("Offer loyalty program enrollment"),s}};q(E,"instance");let ae=E;function ye({onLoginSuccess:o}){const[t,a]=c.useState(""),[s,n]=c.useState(""),[l,i]=c.useState(!1),[u,D]=c.useState(""),w=K.getInstance(),m=async v=>{v.preventDefault(),i(!0),D("");try{const j=await w.login(t,s);j?o(j):D("Invalid username or password")}catch{D("Login failed. Please try again.")}i(!1)};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-900 via-blue-800 to-green-800 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"text-4xl font-bold text-white mb-2",children:"🔐"}),e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"VIP Admin Portal"}),e.jsx("p",{className:"text-blue-200",children:"Cleaning Squad Management System"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-8",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Admin Login"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Access your management dashboard"})]}),e.jsxs("form",{onSubmit:m,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),e.jsx("input",{type:"text",value:t,onChange:v=>a(v.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your username",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),e.jsx("input",{type:"password",value:s,onChange:v=>n(v.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your password",required:!0})]}),u&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsx("p",{className:"text-red-800 text-sm",children:u})}),e.jsx("button",{type:"submit",disabled:l,className:"w-full bg-gradient-to-r from-blue-600 to-green-600 text-white py-3 px-4 rounded-lg font-semibold hover:from-blue-700 hover:to-green-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:l?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Logging in..."]}):"Login to Dashboard"})]}),e.jsx("div",{className:"mt-6 text-center text-xs text-gray-500",children:e.jsx("p",{children:"🔒 Secure admin access • Session expires in 8 hours"})})]}),e.jsx("div",{className:"text-center mt-8 text-blue-200 text-sm",children:e.jsx("p",{children:"© 2024 VIP Cleaning Squad • Admin Portal v1.0"})})]})})}const M=class M{static getInstance(){return M.instance||(M.instance=new M),M.instance}getBlockedTimeSlots(){try{const t=localStorage.getItem("vip_blocked_timeslots");return t?JSON.parse(t):[]}catch{return[]}}blockTimeSlot(t){const a={...t,id:`block_${Date.now()}_${Math.random().toString(36).substring(2)}`,createdAt:new Date().toISOString()},n=[...this.getBlockedTimeSlots(),a];return localStorage.setItem("vip_blocked_timeslots",JSON.stringify(n)),a}unblockTimeSlot(t){const s=this.getBlockedTimeSlots().filter(n=>n.id!==t);return localStorage.setItem("vip_blocked_timeslots",JSON.stringify(s)),!0}blockDateRange(t,a,s,n,l="admin"){const i=[],u=new Date(t),D=new Date(a);for(let w=new Date(u);w<=D;w.setDate(w.getDate()+1)){const m=w.toISOString().split("T")[0],v=this.blockTimeSlot({date:m,time:"00:00",duration:1440,isBlocked:!0,reason:s,teamId:n,createdBy:l});i.push(v)}return i}getOperatingHours(){try{const t=localStorage.getItem("vip_operating_hours");return t?JSON.parse(t):this.getDefaultOperatingHours()}catch{return this.getDefaultOperatingHours()}}updateOperatingHours(t){localStorage.setItem("vip_operating_hours",JSON.stringify(t))}getDefaultOperatingHours(){return[{id:"0",dayOfWeek:0,isOpen:!1,openTime:"09:00",closeTime:"17:00",maxBookingsPerHour:2},{id:"1",dayOfWeek:1,isOpen:!0,openTime:"08:00",closeTime:"20:00",maxBookingsPerHour:4},{id:"2",dayOfWeek:2,isOpen:!0,openTime:"08:00",closeTime:"20:00",maxBookingsPerHour:4},{id:"3",dayOfWeek:3,isOpen:!0,openTime:"08:00",closeTime:"20:00",maxBookingsPerHour:4},{id:"4",dayOfWeek:4,isOpen:!0,openTime:"08:00",closeTime:"20:00",maxBookingsPerHour:4},{id:"5",dayOfWeek:5,isOpen:!0,openTime:"08:00",closeTime:"19:00",maxBookingsPerHour:4},{id:"6",dayOfWeek:6,isOpen:!0,openTime:"09:00",closeTime:"17:00",maxBookingsPerHour:3}]}getTeams(){try{const t=localStorage.getItem("vip_teams");return t?JSON.parse(t):this.getDefaultTeams()}catch{return this.getDefaultTeams()}}updateTeams(t){localStorage.setItem("vip_teams",JSON.stringify(t))}getDefaultTeams(){return[{id:"team_a",name:"Team A",members:["Sarah Johnson","Mike Rodriguez"],color:"#3B82F6",serviceAreas:["St. Catharines","Niagara-on-the-Lake","Thorold"],isActive:!0,workingHours:{1:{start:"08:00",end:"16:00",isWorking:!0},2:{start:"08:00",end:"16:00",isWorking:!0},3:{start:"08:00",end:"16:00",isWorking:!0},4:{start:"08:00",end:"16:00",isWorking:!0},5:{start:"08:00",end:"15:00",isWorking:!0},6:{start:"09:00",end:"14:00",isWorking:!0},0:{start:"10:00",end:"14:00",isWorking:!1}}},{id:"team_b",name:"Team B",members:["Jessica Chen","David Williams"],color:"#10B981",serviceAreas:["Niagara Falls","Welland","Fort Erie"],isActive:!0,workingHours:{1:{start:"10:00",end:"18:00",isWorking:!0},2:{start:"10:00",end:"18:00",isWorking:!0},3:{start:"10:00",end:"18:00",isWorking:!0},4:{start:"10:00",end:"18:00",isWorking:!0},5:{start:"10:00",end:"17:00",isWorking:!0},6:{start:"11:00",end:"16:00",isWorking:!0},0:{start:"12:00",end:"16:00",isWorking:!1}}}]}getHolidays(){try{const t=localStorage.getItem("vip_holidays");return t?JSON.parse(t):this.getDefaultHolidays()}catch{return this.getDefaultHolidays()}}addHoliday(t){const a={...t,id:`holiday_${Date.now()}_${Math.random().toString(36).substring(2)}`,createdAt:new Date().toISOString()},n=[...this.getHolidays(),a];return localStorage.setItem("vip_holidays",JSON.stringify(n)),this.blockDateRange(t.date,t.date,`Holiday: ${t.name}`,void 0,t.createdBy),a}removeHoliday(t){const s=this.getHolidays().filter(n=>n.id!==t);return localStorage.setItem("vip_holidays",JSON.stringify(s)),!0}getDefaultHolidays(){const t=new Date().getFullYear();return[{id:"new_year",name:"New Year's Day",date:`${t}-01-01`,isRecurring:!0,affectedTeams:[],createdBy:"system",createdAt:new Date().toISOString()},{id:"christmas",name:"Christmas Day",date:`${t}-12-25`,isRecurring:!0,affectedTeams:[],createdBy:"system",createdAt:new Date().toISOString()}]}getScheduleSettings(){try{const t=localStorage.getItem("vip_schedule_settings");return t?JSON.parse(t):this.getDefaultScheduleSettings()}catch{return this.getDefaultScheduleSettings()}}updateScheduleSettings(t){localStorage.setItem("vip_schedule_settings",JSON.stringify(t))}getDefaultScheduleSettings(){return{defaultBookingDuration:180,bufferTimeBetweenBookings:30,advanceBookingDays:30,cancellationHours:24,timeSlotInterval:30,maxDailyBookings:8,emergencyServiceAvailable:!0,emergencyServiceMultiplier:1.5}}isTimeSlotAvailable(t,a,s=180,n){const l=this.getBlockedTimeSlots(),i=this.getOperatingHours(),u=this.getHolidays(),D=new Date(t);if(u.some(b=>b.date===t&&(b.affectedTeams.length===0||n&&b.affectedTeams.includes(n))))return!1;const m=D.getDay(),v=i.find(b=>b.dayOfWeek===m);if(!v||!v.isOpen)return!1;const j=new Date(`${t}T${a}:00`),L=new Date(`${t}T${v.openTime}:00`),C=new Date(`${t}T${v.closeTime}:00`),V=new Date(j.getTime()+s*6e4);return j<L||V>C?!1:!l.some(b=>{if(b.date!==t||n&&b.teamId&&b.teamId!==n)return!1;const R=new Date(`${b.date}T${b.time}:00`),W=new Date(R.getTime()+b.duration*6e4);return j<W&&V>R})}getAvailableTimeSlots(t,a){const s=this.getScheduleSettings(),n=this.getOperatingHours(),i=new Date(t).getDay(),u=n.find(j=>j.dayOfWeek===i);if(!u||!u.isOpen)return[];const D=[],w=new Date(`${t}T${u.openTime}:00`),m=new Date(`${t}T${u.closeTime}:00`);let v=new Date(w);for(;v.getTime()+s.defaultBookingDuration*6e4<=m.getTime();){const j=v.toTimeString().substring(0,5);this.isTimeSlotAvailable(t,j,s.defaultBookingDuration,a)&&D.push(j),v=new Date(v.getTime()+s.timeSlotInterval*6e4)}return D}};q(M,"instance");let re=M;const je=[{name:"St. Catharines",lat:43.1594,lng:-79.2469,color:"#3B82F6"},{name:"Niagara Falls",lat:43.0896,lng:-79.0849,color:"#10B981"},{name:"Niagara-on-the-Lake",lat:43.2557,lng:-79.0715,color:"#F59E0B"},{name:"Welland",lat:42.9834,lng:-79.2482,color:"#EF4444"},{name:"Fort Erie",lat:42.9097,lng:-78.9332,color:"#8B5CF6"},{name:"Thorold",lat:43.123,lng:-79.1998,color:"#06B6D4"},{name:"Lincoln",lat:43.1439,lng:-79.4183,color:"#84CC16"},{name:"Pelham",lat:43.0359,lng:-79.3436,color:"#F97316"},{name:"Grimsby",lat:43.1939,lng:-79.5648,color:"#EC4899"},{name:"Port Colborne",lat:42.8858,lng:-79.2517,color:"#6366F1"}],Ne=({adminId:o})=>{var ne;const[t,a]=c.useState("calendar"),[s,n]=c.useState(new Date().toISOString().split("T")[0]),[l,i]=c.useState("week"),u=re.getInstance(),D=new ie,[w,m]=c.useState([]),[v,j]=c.useState([]),[L,C]=c.useState([]),[V,Y]=c.useState([]),[b,R]=c.useState(null),[W,O]=c.useState([]),[X,U]=c.useState(!0),[J,$]=c.useState(!1),[B,A]=c.useState(null),[S,_]=c.useState({name:"",members:[],color:"#3B82F6",serviceAreas:[],isActive:!0,workingHours:{}}),[ee,I]=c.useState(!1),[z,te]=c.useState("single"),[y,H]=c.useState({startDate:"",endDate:"",reason:"",teamId:"",time:"09:00",duration:480}),[g,p]=c.useState(!1),[x,k]=c.useState({name:"",date:"",isRecurring:!1,affectedTeams:[]});c.useEffect(()=>{Q()},[]);const Q=async()=>{U(!0);try{const[r,d,h,N,f,T]=await Promise.all([Promise.resolve(u.getTeams()),Promise.resolve(u.getBlockedTimeSlots()),Promise.resolve(u.getHolidays()),Promise.resolve(u.getOperatingHours()),Promise.resolve(u.getScheduleSettings()),D.getBookings()]);m(r),j(d),C(h),Y(N),R(f),O(T)}catch(r){console.error("Error loading schedule data:",r)}U(!1)},F=c.useCallback(()=>{const r=new Date(s),d=[];if(l==="month"){const h=new Date(r.getFullYear(),r.getMonth(),1);new Date(r.getFullYear(),r.getMonth()+1,0);const N=new Date(h);N.setDate(N.getDate()-h.getDay());for(let f=0;f<42;f++){const T=new Date(N);T.setDate(N.getDate()+f),d.push(T.toISOString().split("T")[0])}}else if(l==="week"){const h=new Date(r);h.setDate(r.getDate()-r.getDay());for(let N=0;N<7;N++){const f=new Date(h);f.setDate(h.getDate()+N),d.push(f.toISOString().split("T")[0])}}else d.push(s);return d},[s,l]),le=()=>{if(!S.name)return;const r={id:(B==null?void 0:B.id)||`team_${Date.now()}`,name:S.name,members:S.members||[],color:S.color||"#3B82F6",serviceAreas:S.serviceAreas||[],isActive:S.isActive??!0,workingHours:S.workingHours||{}},d=B?w.map(h=>h.id===B.id?r:h):[...w,r];m(d),u.updateTeams(d),$(!1),A(null),_({name:"",members:[],color:"#3B82F6",serviceAreas:[],isActive:!0,workingHours:{}})},oe=()=>{!y.startDate||!y.reason||(z==="range"&&y.endDate?u.blockDateRange(y.startDate,y.endDate,y.reason,y.teamId||void 0,o):u.blockTimeSlot({date:y.startDate,time:y.time,duration:y.duration,isBlocked:!0,reason:y.reason,teamId:y.teamId||void 0,createdBy:o}),j(u.getBlockedTimeSlots()),I(!1),H({startDate:"",endDate:"",reason:"",teamId:"",time:"09:00",duration:480}))},ce=()=>{!x.name||!x.date||(u.addHoliday({name:x.name,date:x.date,isRecurring:x.isRecurring,affectedTeams:x.affectedTeams,createdBy:o}),C(u.getHolidays()),p(!1),k({name:"",date:"",isRecurring:!1,affectedTeams:[]}))},de=r=>{const h=W.filter(f=>f.serviceDate===r&&f.status==="scheduled").reduce((f,T)=>{const G=T.serviceArea;return f[G]||(f[G]=[]),f[G].push(T),f},{});return Object.entries(h).map(([f,T])=>{const G=T.length,se=[...new Set(T.map(he=>he.assignedTeam).filter(Boolean))],xe=se.length>0?G/se.length:0;return{area:f,bookings:G,teams:se.length,efficiency:xe.toFixed(1),avgTravelTime:me(f,T)}})},me=(r,d)=>{const N=d.length;return Math.round(15+N*5)},Z=(r,d)=>W.filter(h=>h.serviceDate===r&&(d?h.assignedTeam===d:!0)&&h.status==="scheduled"),ge=(r,d)=>v.some(h=>h.date===r&&h.isBlocked&&(d?h.teamId===d||!h.teamId:!0)),ue=r=>L.some(d=>d.date===r||d.isRecurring&&d.date.slice(5)===r.slice(5));return X?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Schedule Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage teams, bookings, and optimize routes across Niagara region"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:()=>$(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"+ Add Team"}),e.jsx("button",{onClick:()=>I(!0),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"🚫 Block Time"}),e.jsx("button",{onClick:()=>p(!0),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"🎄 Add Holiday"})]})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex space-x-8",children:[{id:"calendar",label:"Calendar View",icon:"📅"},{id:"teams",label:"Team Management",icon:"👥"},{id:"routes",label:"Route Optimization",icon:"🗺️"},{id:"analytics",label:"Schedule Analytics",icon:"📊"},{id:"settings",label:"Settings",icon:"⚙️"}].map(r=>e.jsxs("button",{onClick:()=>a(r.id),className:`py-2 px-1 border-b-2 font-medium text-sm ${t===r.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[r.icon," ",r.label]},r.id))})}),t==="calendar"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("input",{type:"date",value:s,onChange:r=>n(r.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),e.jsx("div",{className:"flex bg-gray-100 rounded-lg p-1",children:["month","week","day"].map(r=>e.jsx("button",{onClick:()=>i(r),className:`px-3 py-1 rounded-md text-sm font-medium ${l===r?"bg-white text-blue-600 shadow":"text-gray-600 hover:text-gray-900"}`,children:r.charAt(0).toUpperCase()+r.slice(1)},r))})]}),e.jsx("div",{className:"text-sm text-gray-600",children:new Date(s).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"grid grid-cols-8 border-b border-gray-200",children:[e.jsx("div",{className:"p-3 bg-gray-50 text-sm font-medium text-gray-700",children:"Team"}),F().slice(0,7).map(r=>e.jsxs("div",{className:"p-3 bg-gray-50 text-sm font-medium text-gray-700 text-center",children:[e.jsx("div",{children:new Date(r).toLocaleDateString("en-US",{weekday:"short"})}),e.jsx("div",{children:new Date(r).getDate()})]},r))]}),w.filter(r=>r.isActive).map(r=>e.jsxs("div",{className:"grid grid-cols-8 border-b border-gray-100 hover:bg-gray-50",children:[e.jsxs("div",{className:"p-3 border-r border-gray-200 flex items-center",children:[e.jsx("div",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:r.color}}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:r.name}),e.jsx("div",{className:"text-xs text-gray-500",children:r.serviceAreas.join(", ")})]})]}),F().slice(0,7).map(d=>{const h=Z(d,r.id),N=ge(d,r.id),f=ue(d);return e.jsxs("div",{className:"p-2 border-r border-gray-100 min-h-[80px]",children:[f&&e.jsx("div",{className:"text-xs bg-purple-100 text-purple-800 rounded px-1 py-0.5 mb-1",children:"Holiday"}),N&&e.jsx("div",{className:"text-xs bg-red-100 text-red-800 rounded px-1 py-0.5 mb-1",children:"Blocked"}),h.map(T=>e.jsxs("div",{className:"text-xs bg-blue-100 text-blue-800 rounded px-1 py-0.5 mb-1 cursor-pointer hover:bg-blue-200",title:`${T.customerName} - ${T.serviceType} - ${T.serviceTime}`,children:[T.serviceTime," - ",T.customerName.split(" ")[0]]},T.id))]},`${r.id}-${d}`)})]},r.id))]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-100 rounded mr-1"}),e.jsx("span",{children:"Scheduled Booking"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-3 h-3 bg-red-100 rounded mr-1"}),e.jsx("span",{children:"Blocked Time"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-3 h-3 bg-purple-100 rounded mr-1"}),e.jsx("span",{children:"Holiday"})]})]})]}),t==="teams"&&e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:w.map(r=>e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-4 h-4 rounded-full mr-3",style:{backgroundColor:r.color}}),e.jsx("h3",{className:"text-lg font-semibold",children:r.name})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>{A(r),_(r),$(!0)},className:"text-blue-600 hover:text-blue-800 text-sm",children:"Edit"}),e.jsx("button",{onClick:()=>{const d=w.map(h=>h.id===r.id?{...h,isActive:!h.isActive}:h);m(d),u.updateTeams(d)},className:`text-sm ${r.isActive?"text-red-600 hover:text-red-800":"text-green-600 hover:text-green-800"}`,children:r.isActive?"Deactivate":"Activate"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-1",children:"Team Members"}),e.jsx("div",{className:"text-sm text-gray-600",children:r.members.length>0?r.members.join(", "):"No members assigned"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-1",children:"Service Areas"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:r.serviceAreas.map(d=>e.jsx("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:d},d))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${r.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:r.isActive?"Active":"Inactive"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-1",children:"Today's Schedule"}),e.jsxs("div",{className:"text-sm text-gray-600",children:[Z(s,r.id).length," bookings"]})]})]})]},r.id))})}),t==="routes"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4",children:["Route Optimization for ",new Date(s).toLocaleDateString()]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:de(s).map(r=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-medium",children:r.area}),e.jsxs("div",{className:`text-xs px-2 py-1 rounded-full ${Number.parseFloat(r.efficiency)>2?"bg-green-100 text-green-800":Number.parseFloat(r.efficiency)>1?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[r.efficiency," efficiency"]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Bookings:"}),e.jsx("span",{className:"font-medium",children:r.bookings})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Teams:"}),e.jsx("span",{className:"font-medium",children:r.teams})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Avg Travel:"}),e.jsxs("span",{className:"font-medium",children:[r.avgTravelTime," min"]})]})]})]},r.area))}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"🚀 Optimization Recommendations"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"• Consider grouping bookings in St. Catharines and Thorold for Team A"}),e.jsx("li",{children:"• Niagara Falls and Welland can be efficiently served by Team B"}),e.jsx("li",{children:"• Schedule buffer time of 30 minutes between distant locations"}),e.jsx("li",{children:"• Peak efficiency achieved with 2-3 bookings per team per area"})]})]})]})}),t==="analytics"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Total Bookings Today"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Z(s).length})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Active Teams"}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:w.filter(r=>r.isActive).length})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Blocked Time Slots"}),e.jsx("div",{className:"text-2xl font-bold text-red-600",children:v.filter(r=>r.date===s).length})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Upcoming Holidays"}),e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:L.filter(r=>new Date(r.date)>new Date).length})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Team Utilization"}),e.jsx("div",{className:"space-y-4",children:w.filter(r=>r.isActive).map(r=>{const N=Z(s,r.id).length/4*100;return e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-24 text-sm font-medium",children:r.name}),e.jsx("div",{className:"flex-1 mx-4",children:e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"h-2 rounded-full",style:{width:`${Math.min(N,100)}%`,backgroundColor:r.color}})})}),e.jsxs("div",{className:"w-16 text-sm text-gray-600",children:[N.toFixed(0),"%"]})]},r.id)})})]})]}),t==="settings"&&b&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Schedule Settings"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Default Booking Duration (minutes)"}),e.jsx("input",{type:"number",value:b.defaultBookingDuration,onChange:r=>R({...b,defaultBookingDuration:Number.parseInt(r.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Buffer Time Between Bookings (minutes)"}),e.jsx("input",{type:"number",value:b.bufferTimeBetweenBookings,onChange:r=>R({...b,bufferTimeBetweenBookings:Number.parseInt(r.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Maximum Daily Bookings"}),e.jsx("input",{type:"number",value:b.maxDailyBookings,onChange:r=>R({...b,maxDailyBookings:Number.parseInt(r.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Advance Booking Days"}),e.jsx("input",{type:"number",value:b.advanceBookingDays,onChange:r=>R({...b,advanceBookingDays:Number.parseInt(r.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:()=>u.updateScheduleSettings(b),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Save Settings"})})]})}),J&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b",children:e.jsx("h3",{className:"text-lg font-semibold",children:B?"Edit Team":"Add New Team"})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Team Name"}),e.jsx("input",{type:"text",value:S.name||"",onChange:r=>_({...S,name:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter team name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Team Color"}),e.jsx("input",{type:"color",value:S.color||"#3B82F6",onChange:r=>_({...S,color:r.target.value}),className:"w-20 h-10 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Service Areas"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:je.map(r=>{var d;return e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:((d=S.serviceAreas)==null?void 0:d.includes(r.name))||!1,onChange:h=>{const N=S.serviceAreas||[];h.target.checked?_({...S,serviceAreas:[...N,r.name]}):_({...S,serviceAreas:N.filter(f=>f!==r.name)})},className:"mr-2"}),e.jsx("span",{className:"text-sm",children:r.name})]},r.name)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Team Members"}),e.jsx("textarea",{value:((ne=S.members)==null?void 0:ne.join(", "))||"",onChange:r=>_({...S,members:r.target.value.split(",").map(d=>d.trim()).filter(d=>d)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter member names separated by commas",rows:3})]})]}),e.jsxs("div",{className:"p-6 border-t flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{$(!1),A(null),_({name:"",members:[],color:"#3B82F6",serviceAreas:[],isActive:!0,workingHours:{}})},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:le,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:B?"Update Team":"Add Team"})]})]})}),ee&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-lg w-full",children:[e.jsx("div",{className:"p-6 border-b",children:e.jsx("h3",{className:"text-lg font-semibold",children:"Block Time Slot"})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Block Type"}),e.jsxs("select",{value:z,onChange:r=>te(r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"single",children:"Single Date"}),e.jsx("option",{value:"range",children:"Date Range"}),e.jsx("option",{value:"recurring",children:"Recurring"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",value:y.startDate,onChange:r=>H({...y,startDate:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),z==="range"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),e.jsx("input",{type:"date",value:y.endDate,onChange:r=>H({...y,endDate:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason"}),e.jsx("input",{type:"text",value:y.reason,onChange:r=>H({...y,reason:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Holiday, Maintenance, Team Unavailable"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Affected Team (Optional)"}),e.jsxs("select",{value:y.teamId,onChange:r=>H({...y,teamId:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Teams"}),w.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]})]})]}),e.jsxs("div",{className:"p-6 border-t flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>I(!1),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:oe,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Block Time"})]})]})}),g&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-lg w-full",children:[e.jsx("div",{className:"p-6 border-b",children:e.jsx("h3",{className:"text-lg font-semibold",children:"Add Holiday"})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Holiday Name"}),e.jsx("input",{type:"text",value:x.name,onChange:r=>k({...x,name:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Christmas Day, New Year's Day"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date"}),e.jsx("input",{type:"date",value:x.date,onChange:r=>k({...x,date:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:x.isRecurring,onChange:r=>k({...x,isRecurring:r.target.checked}),className:"mr-2"}),e.jsx("span",{className:"text-sm",children:"Recurring Annual Holiday"})]})})]}),e.jsxs("div",{className:"p-6 border-t flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>p(!1),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:ce,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Add Holiday"})]})]})})]})},Oe=()=>{const[o,t]=c.useState(null),[a,s]=c.useState("overview"),[n,l]=c.useState([]),[i,u]=c.useState([]),[D,w]=c.useState([]),[m,v]=c.useState(null),[j,L]=c.useState([]),[C,V]=c.useState([]),[Y,b]=c.useState(!0),[R,W]=c.useState(!1),[O,X]=c.useState({bookingsCount:0,transactionsCount:0,rawBookings:"",rawTransactions:""}),U=K.getInstance(),J=new ie;ve.getInstance();const $=ae.getInstance(),B=c.useCallback(()=>{const g=localStorage.getItem("vip_admin_bookings")||"[]",p=localStorage.getItem("vip_admin_transactions")||"[]";try{const x=JSON.parse(g),k=JSON.parse(p);X({bookingsCount:x.length,transactionsCount:k.length,rawBookings:g,rawTransactions:p})}catch(x){console.error("Error parsing storage data:",x)}},[]),A=c.useCallback(()=>{try{console.log("🧠 Loading Business Intelligence Data...");const g=$.getBusinessMetrics(),p=$.getCustomerInsights(),x=$.getPerformanceAlerts();v(g),L(p),V(x),console.log("📊 Business Metrics:",g),console.log("👥 Customer Insights:",p),console.log("⚠️ Performance Alerts:",x)}catch(g){console.error("Error loading business intelligence:",g)}},[$]),S=()=>{const g={id:`test_booking_${Date.now()}`,bookingNumber:`TEST${Date.now()}`,customerName:"Test Customer",customerEmail:"test@example.com",customerPhone:"(555) 123-4567",serviceType:"residential",serviceDate:new Date().toISOString().split("T")[0],serviceTime:"10:00",serviceAddress:"123 Test Street, Test City, ON A1B 2C3",serviceArea:"Test Area",amount:99.99,status:"scheduled",paymentStatus:"paid",cleaningType:"standard",frequency:"onetime",addOns:["Test Add-on"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},p={id:`test_transaction_${Date.now()}`,customerName:"Test Customer",customerEmail:"test@example.com",customerPhone:"(555) 123-4567",serviceType:"residential",amount:99.99,paymentMethod:"paypal",paypalOrderId:`test_order_${Date.now()}`,status:"completed",createdAt:new Date().toISOString(),serviceDate:new Date().toISOString().split("T")[0],serviceTime:"10:00",serviceAddress:"123 Test Street, Test City, ON A1B 2C3",serviceArea:"Test Area",addOns:["Test Add-on"],frequency:"onetime",bookingNumber:g.bookingNumber};try{const x=JSON.parse(localStorage.getItem("vip_admin_bookings")||"[]"),k=JSON.parse(localStorage.getItem("vip_admin_transactions")||"[]");x.unshift(g),k.unshift(p),localStorage.setItem("vip_admin_bookings",JSON.stringify(x)),localStorage.setItem("vip_admin_transactions",JSON.stringify(k)),console.log("✅ Test booking and transaction created successfully!"),console.log("📅 Test Booking:",g),console.log("💳 Test Transaction:",p),I(),B(),A(),alert(`✅ Test booking created successfully!

Booking: ${g.bookingNumber}
Transaction: ${p.id}

Check the admin dashboard tabs to see the new data.`)}catch(x){console.error("❌ Error creating test booking:",x),alert("❌ Error creating test booking. Check console for details.")}},_=()=>{confirm("Are you sure you want to clear ALL booking and transaction data? This cannot be undone.")&&(localStorage.removeItem("vip_admin_bookings"),localStorage.removeItem("vip_admin_transactions"),u([]),l([]),v(null),L([]),V([]),B(),A(),alert("🗑️ All data cleared successfully!"))},ee=()=>{const g=localStorage.getItem("vip_admin_bookings")||"[]",p=localStorage.getItem("vip_admin_transactions")||"[]",x={bookings:JSON.parse(g),transactions:JSON.parse(p),businessMetrics:m,customerInsights:j,performanceAlerts:C,exportDate:new Date().toISOString()},k=new Blob([JSON.stringify(x,null,2)],{type:"application/json"}),Q=URL.createObjectURL(k),F=document.createElement("a");F.href=Q,F.download=`vip-business-intelligence-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(F),F.click(),document.body.removeChild(F),URL.revokeObjectURL(Q),console.log("📄 Business Intelligence data exported successfully")};c.useEffect(()=>{I(),B(),A();const g=()=>{B(),I(),A()};window.addEventListener("storage",g);const p=setInterval(()=>{B(),A()},1e4);return()=>{window.removeEventListener("storage",g),clearInterval(p)}},[B,A]);const I=async()=>{const g=U.getCurrentSession();if(!g){b(!1);return}t(g);try{const[p,x,k]=await Promise.all([J.getTransactions(),J.getBookings(),z()]);console.log("🔍 ADMIN DEBUG - Transactions found:",p.length),console.log("🔍 ADMIN DEBUG - Bookings found:",x.length),console.log("🔍 ADMIN DEBUG - Customers found:",k.length),console.log("📊 ADMIN DEBUG - Raw bookings data:",x),console.log("💳 ADMIN DEBUG - Raw transactions data:",p),l(p),u(x),w(k)}catch(p){console.error("Error loading admin data:",p)}b(!1)},z=()=>{try{const g=localStorage.getItem("vip_customers");return g?JSON.parse(g):[]}catch{return[]}},te=async()=>{await U.logout(),t(null)},y=async(g,p)=>{try{await J.updateBookingStatus(g,p),u(x=>x.map(k=>k.id===g?{...k,status:p}:k)),A()}catch(x){console.error("Error updating booking status:",x)}},H=async g=>{if(confirm("Are you sure you want to process this refund?"))try{await J.refundTransaction(g),l(p=>p.map(x=>x.id===g?{...x,status:"refunded"}:x)),A()}catch(p){console.error("Error processing refund:",p)}};return o?Y?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-4",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-center",children:[e.jsxs("div",{className:"mb-4 lg:mb-0",children:[e.jsx("h1",{className:"text-xl lg:text-2xl font-bold text-gray-900",children:"VIP Admin Dashboard"}),e.jsxs("p",{className:"text-gray-600 text-sm lg:text-base",children:["Welcome back, ",o.admin.username]}),e.jsxs("div",{className:"mt-2 text-xs space-y-1",children:[e.jsxs("div",{className:"text-green-600 font-medium",children:["📊 Live Data: ",O.bookingsCount," bookings, ",O.transactionsCount," transactions"]}),m&&e.jsxs("div",{className:"text-blue-600",children:["💰 Total Revenue: $",m.totalRevenue.toFixed(2)," | 📈 Growth: ",m.revenueGrowth.monthly.toFixed(1),"% | 👥 CLV: $",m.customerLifetimeValue.toFixed(2)]}),C.length>0&&e.jsxs("div",{className:"text-orange-600",children:["⚠️ ",C.length," performance alerts requiring attention"]}),e.jsxs("div",{className:"text-purple-600",children:["🔄 Last updated: ",new Date().toLocaleTimeString()," | BI Engine: Active"]}),e.jsx("div",{className:"text-purple-600 lg:hidden",children:"📱 Mobile Admin Mode: Touch-optimized interface with full BI"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center space-y-2 sm:space-y-0 sm:space-x-3",children:[e.jsxs("button",{onClick:()=>W(!R),className:`px-3 py-2 rounded-lg text-xs lg:text-sm font-medium transition-colors touch-manipulation ${R?"bg-yellow-100 text-yellow-800 border border-yellow-300":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["🔧 ",R?"Hide Debug":"Show Debug"]}),e.jsx("button",{onClick:S,className:"px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-xs lg:text-sm font-medium touch-manipulation",children:"➕ Create Test Booking"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:ee,className:"flex-1 sm:flex-none px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-xs lg:text-sm touch-manipulation",children:"📊 Export BI"}),e.jsx("button",{onClick:_,className:"flex-1 sm:flex-none px-3 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-xs lg:text-sm touch-manipulation",children:"🗑️ Clear"}),e.jsx("button",{onClick:()=>{console.log("🧠 BUSINESS INTELLIGENCE SUMMARY:"),console.log("Revenue Metrics:",m),console.log("Customer Insights:",j),console.log("Performance Alerts:",C);const g=m?`📊 Business Intelligence Summary:

💰 Total Revenue: $${m.totalRevenue.toFixed(2)}
📈 Monthly Growth: ${m.revenueGrowth.monthly.toFixed(1)}%
👥 Total Customers: ${m.totalCustomers}
📋 Total Bookings: ${m.totalBookings}
💎 Avg CLV: $${m.customerLifetimeValue.toFixed(2)}
⚠️ Performance Alerts: ${C.length}
🎯 Conversion Rate: ${m.bookingConversionRate.toFixed(1)}%

🔍 Full details in console!`:"Business Intelligence data loading...";alert(g)},className:"px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-xs lg:text-sm touch-manipulation",title:"Business Intelligence Summary",children:"🧠 BI"})]}),e.jsx("span",{className:"text-xs lg:text-sm text-gray-500 text-center sm:text-left",children:o.admin.role.replace("_"," ").toUpperCase()}),e.jsx("button",{onClick:te,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-xs lg:text-sm touch-manipulation",children:"Sign Out"})]})]}),R&&e.jsxs("div",{className:"mt-4 p-3 lg:p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-yellow-900 mb-3 text-sm lg:text-base",children:"🔧 Admin Debug Console + Business Intelligence"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 text-xs lg:text-sm",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-yellow-800",children:"Storage & Data:"}),e.jsxs("div",{className:"space-y-1 font-mono text-xs",children:[e.jsxs("div",{children:["📅 vip_admin_bookings: ",O.bookingsCount," items"]}),e.jsxs("div",{children:["💳 vip_admin_transactions: ",O.transactionsCount," items"]}),e.jsxs("div",{children:["👥 vip_customers: ",JSON.parse(localStorage.getItem("vip_customers")||"[]").length," items"]}),e.jsxs("div",{className:"lg:hidden text-purple-600",children:["📱 Mobile viewport: ",window.innerWidth,"x",window.innerHeight]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-yellow-800",children:"Business Intelligence:"}),e.jsx("div",{className:"space-y-1 font-mono text-xs",children:m?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["💰 Revenue: $",m.totalRevenue.toFixed(2)]}),e.jsxs("div",{children:["📈 Growth: ",m.revenueGrowth.monthly.toFixed(1),"%"]}),e.jsxs("div",{children:["👥 CLV: $",m.customerLifetimeValue.toFixed(2)]}),e.jsxs("div",{children:["⚠️ Alerts: ",C.length]}),e.jsxs("div",{children:["🎯 Conversion: ",m.bookingConversionRate.toFixed(1),"%"]})]}):e.jsx("div",{children:"📊 Loading BI data..."})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-yellow-800",children:"Actions:"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("button",{onClick:()=>{console.log("🔍 RAW STORAGE DUMP:"),console.log("📅 Bookings:",O.rawBookings),console.log("💳 Transactions:",O.rawTransactions),console.log("🧠 Business Metrics:",m),console.log("👥 Customer Insights:",j),B(),I(),A()},className:"block w-full text-left px-2 py-1 bg-yellow-100 hover:bg-yellow-200 rounded text-yellow-800 touch-manipulation text-xs",children:"🔍 Dump All Data to Console"}),e.jsx("button",{onClick:()=>{B(),I(),A(),alert(`✅ All data refreshed!

Bookings: ${O.bookingsCount}
Transactions: ${O.transactionsCount}
BI Status: ${m?"Loaded":"Loading"}`)},className:"block w-full text-left px-2 py-1 bg-yellow-100 hover:bg-yellow-200 rounded text-yellow-800 touch-manipulation text-xs",children:"🔄 Force Refresh All Data + BI"})]})]})]}),e.jsx("div",{className:"mt-3 p-2 bg-gray-100 rounded text-xs font-mono max-h-32 overflow-y-auto",children:e.jsxs("div",{className:"break-all",children:["📊 Latest BI Snapshot: ",m?`Revenue: $${m.totalRevenue.toFixed(2)}, Growth: ${m.revenueGrowth.monthly.toFixed(1)}%, Customers: ${m.totalCustomers}, Alerts: ${C.length}`:"Loading..."]})})]})]})}),e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4",children:e.jsx("nav",{className:"flex flex-wrap -mb-px",children:[{id:"overview",label:"Overview",icon:"📊"},{id:"analytics",label:"Business Intelligence",icon:"🧠"},{id:"alerts",label:`Alerts (${C.length})`,icon:"⚠️"},{id:"insights",label:`Customer Insights (${j.length})`,icon:"👥"},{id:"scheduling",label:"Schedule",icon:"📅"},{id:"bookings",label:`Bookings (${i.length})`,icon:"📋"},{id:"transactions",label:`Transactions (${n.length})`,icon:"💳"},{id:"customers",label:"Customers",icon:"👤"}].map(g=>e.jsxs("button",{onClick:()=>s(g.id),className:`py-3 lg:py-4 px-2 lg:px-3 border-b-2 font-medium text-xs lg:text-sm touch-manipulation ${a===g.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx("span",{className:"block lg:inline",children:g.icon}),e.jsx("span",{className:"hidden sm:inline lg:ml-1",children:g.label})]},g.id))})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[a==="overview"&&e.jsx(we,{transactions:n,bookings:i,customers:D,businessMetrics:m}),a==="analytics"&&e.jsx(Se,{businessMetrics:m,businessIntelligence:$}),a==="alerts"&&e.jsx(ke,{alerts:C,businessMetrics:m}),a==="insights"&&e.jsx(Te,{insights:j}),a==="scheduling"&&e.jsx(Ne,{adminId:o.admin.id}),a==="bookings"&&e.jsx(De,{bookings:i,onBookingUpdate:y,onDataRefresh:I}),a==="transactions"&&e.jsx(Be,{transactions:n,onRefund:H,onDataRefresh:I}),a==="customers"&&e.jsx(Ce,{customers:D})]})]}):e.jsx(ye,{onLoginSuccess:t})},we=({transactions:o,bookings:t,customers:a,businessMetrics:s})=>s?e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-gradient-to-br from-green-500 to-green-600 rounded-lg shadow-lg p-6 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-100 text-sm font-medium",children:"Total Revenue"}),e.jsxs("p",{className:"text-3xl font-bold",children:["$",s.totalRevenue.toFixed(2)]}),e.jsxs("p",{className:"text-green-200 text-xs mt-1",children:[s.revenueGrowth.monthly>=0?"↗️":"↘️",Math.abs(s.revenueGrowth.monthly).toFixed(1),"% this month"]})]}),e.jsx("div",{className:"text-4xl opacity-80",children:"💰"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg shadow-lg p-6 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-100 text-sm font-medium",children:"Customer Lifetime Value"}),e.jsxs("p",{className:"text-3xl font-bold",children:["$",s.customerLifetimeValue.toFixed(2)]}),e.jsx("p",{className:"text-blue-200 text-xs mt-1",children:"Avg per customer"})]}),e.jsx("div",{className:"text-4xl opacity-80",children:"👥"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 rounded-lg shadow-lg p-6 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-purple-100 text-sm font-medium",children:"Conversion Rate"}),e.jsxs("p",{className:"text-3xl font-bold",children:[s.bookingConversionRate.toFixed(1),"%"]}),e.jsx("p",{className:"text-purple-200 text-xs mt-1",children:"Booking success rate"})]}),e.jsx("div",{className:"text-4xl opacity-80",children:"🎯"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-orange-500 to-orange-600 rounded-lg shadow-lg p-6 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-orange-100 text-sm font-medium",children:"Customer Retention"}),e.jsxs("p",{className:"text-3xl font-bold",children:[s.customerRetentionRate.toFixed(1),"%"]}),e.jsxs("p",{className:"text-orange-200 text-xs mt-1",children:[Math.round((100-s.churnRate)*10)/10,"% retention"]})]}),e.jsx("div",{className:"text-4xl opacity-80",children:"🔄"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Revenue by Service Type"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-green-500 rounded mr-3"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Residential"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-semibold text-gray-900",children:["$",s.revenueByService.residential.toFixed(2)]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[s.totalRevenue>0?(s.revenueByService.residential/s.totalRevenue*100).toFixed(1):0,"%"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-blue-500 rounded mr-3"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Commercial"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-semibold text-gray-900",children:["$",s.revenueByService.commercial.toFixed(2)]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[s.totalRevenue>0?(s.revenueByService.commercial/s.totalRevenue*100).toFixed(1):0,"%"]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Customer Analytics"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Total Customers"}),e.jsx("span",{className:"font-semibold text-gray-900",children:s.totalCustomers})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"New This Month"}),e.jsx("span",{className:"font-semibold text-green-600",children:s.newCustomers})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Returning Customers"}),e.jsx("span",{className:"font-semibold text-blue-600",children:s.returningCustomers})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Average Order Value"}),e.jsxs("span",{className:"font-semibold text-purple-600",children:["$",s.averageOrderValue.toFixed(2)]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Performing Service Areas"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:s.topPerformingAreas.map((n,l)=>e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl mb-2",children:l===0?"🥇":l===1?"🥈":"🥉"}),e.jsx("h4",{className:"font-semibold text-gray-900",children:n}),e.jsx("p",{className:"text-sm text-gray-600",children:"High performance area"})]},n))})]})]}):e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mr-3"}),e.jsx("span",{className:"text-gray-600",children:"Loading Business Intelligence..."})]}),Se=({businessMetrics:o,businessIntelligence:t})=>{const[a,s]=c.useState("month"),[n,l]=c.useState([]);return c.useEffect(()=>{const i=t.getRevenueTrends(a);l(i)},[a,t]),o?e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 rounded-lg shadow-lg p-6 text-white",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"🧠 Business Intelligence Dashboard"}),e.jsx("p",{className:"text-purple-100",children:"Advanced analytics and predictive insights for your cleaning business"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Revenue Trends"}),e.jsxs("select",{value:a,onChange:i=>s(i.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm",children:[e.jsx("option",{value:"week",children:"Weekly"}),e.jsx("option",{value:"month",children:"Monthly"}),e.jsx("option",{value:"quarter",children:"Quarterly"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["$",o.totalRevenue.toFixed(2)]}),e.jsx("div",{className:"text-sm text-green-700",children:"Total Revenue"})]}),e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:["$",o.monthlyRevenue.toFixed(2)]}),e.jsx("div",{className:"text-sm text-blue-700",children:"This Month"})]}),e.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[o.revenueGrowth.monthly.toFixed(1),"%"]}),e.jsx("div",{className:"text-sm text-purple-700",children:"Monthly Growth"})]}),e.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:["$",o.averageOrderValue.toFixed(2)]}),e.jsx("div",{className:"text-sm text-orange-700",children:"Avg Order Value"})]})]}),e.jsx("div",{className:"space-y-2",children:n.slice(-6).map((i,u)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:new Date(i.date).toLocaleDateString()}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[i.bookings," bookings"]}),e.jsxs("div",{className:"text-sm font-semibold text-green-600",children:["$",i.revenue.toFixed(2)]}),e.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${Math.min(100,i.revenue/Math.max(...n.slice(-6).map(D=>D.revenue))*100)}%`}})})]})]},i.date))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"🔮 Predictive Analytics"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Demand Forecast (Next 4 Weeks)"}),e.jsx("div",{className:"space-y-3",children:o.demandForecast.slice(0,4).map((i,u)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-blue-900",children:new Date(i.date).toLocaleDateString()}),e.jsxs("div",{className:"text-xs text-blue-600",children:["Confidence: ",(i.confidence*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-semibold text-blue-700",children:[i.predictedBookings," bookings"]}),e.jsxs("div",{className:"text-sm text-blue-600",children:["$",i.predictedRevenue.toFixed(2)]})]})]},i.date))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Seasonal Trends"}),e.jsx("div",{className:"space-y-3",children:o.seasonalTrends.map(i=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:i.period}),e.jsxs("span",{className:`px-2 py-1 text-xs rounded-full ${i.pattern==="high"?"bg-green-100 text-green-800":i.pattern==="medium"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[i.pattern," demand"]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[i.demandMultiplier,"x demand multiplier"]})]},i.period))})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"🎯 Strategic Recommendations"}),e.jsx("div",{className:"space-y-4",children:o.recommendedActions.map(i=>e.jsxs("div",{className:"border-l-4 border-blue-500 pl-4 py-3 bg-blue-50",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h4",{className:"font-semibold text-blue-900",children:i.title}),e.jsxs("span",{className:`px-2 py-1 text-xs rounded-full ${i.priority==="high"?"bg-red-100 text-red-800":i.priority==="medium"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:[i.priority," priority"]})]}),e.jsx("p",{className:"text-sm text-blue-700 mb-2",children:i.description}),e.jsxs("div",{className:"text-sm text-blue-600",children:[e.jsx("strong",{children:"Impact:"})," ",i.potentialImpact," |",e.jsx("strong",{children:" Timeline:"})," ",i.timeline," |",e.jsx("strong",{children:" ROI:"})," ",i.expectedRoi,"%"]})]},`${i.category}-${i.title}`))})]})]}):e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mr-3"}),e.jsx("span",{className:"text-gray-600",children:"Loading Business Intelligence..."})]})},ke=({alerts:o,businessMetrics:t})=>{const a=o.filter(i=>i.type==="critical"),s=o.filter(i=>i.type==="warning"),n=o.filter(i=>i.type==="opportunity"),l=o.filter(i=>i.type==="success");return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:a.length}),e.jsx("div",{className:"text-sm text-red-700",children:"Critical Issues"})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:s.length}),e.jsx("div",{className:"text-sm text-yellow-700",children:"Warnings"})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n.length}),e.jsx("div",{className:"text-sm text-blue-700",children:"Opportunities"})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:l.length}),e.jsx("div",{className:"text-sm text-green-700",children:"Successes"})]})]}),e.jsx("div",{className:"space-y-4",children:o.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-4xl mb-4",children:"🎉"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Active Alerts"}),e.jsx("p",{className:"text-gray-600",children:"Your business is running smoothly!"})]}):o.map(i=>e.jsx("div",{className:`rounded-lg border-l-4 p-4 ${i.type==="critical"?"bg-red-50 border-red-500":i.type==="warning"?"bg-yellow-50 border-yellow-500":i.type==="opportunity"?"bg-blue-50 border-blue-500":"bg-green-50 border-green-500"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:`font-semibold ${i.type==="critical"?"text-red-900":i.type==="warning"?"text-yellow-900":i.type==="opportunity"?"text-blue-900":"text-green-900"}`,children:i.title}),e.jsx("p",{className:`text-sm mt-1 ${i.type==="critical"?"text-red-700":i.type==="warning"?"text-yellow-700":i.type==="opportunity"?"text-blue-700":"text-green-700"}`,children:i.message}),e.jsxs("div",{className:"mt-3",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-900 mb-1",children:"Suggestions:"}),e.jsx("ul",{className:"text-sm text-gray-700 space-y-1",children:i.suggestions.map(u=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-gray-400 mr-2",children:"•"}),u]},`${i.id}-${u.substring(0,20)}`))})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-2xl font-bold ${i.type==="critical"?"text-red-600":i.type==="warning"?"text-yellow-600":i.type==="opportunity"?"text-blue-600":"text-green-600"}`,children:i.trend==="up"?"↗️":i.trend==="down"?"↘️":"➡️"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:new Date(i.createdAt).toLocaleDateString()})]})]})},i.id))})]})},Te=({insights:o})=>{const[t,a]=c.useState("lifetimeValue"),s=[...o].sort((n,l)=>{if(t==="churnRisk"){const i={high:3,medium:2,low:1};return i[l.churnRisk]-i[n.churnRisk]}return l[t]-n[t]});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:o.filter(n=>n.churnRisk==="low").length}),e.jsx("div",{className:"text-sm text-green-700",children:"Low Churn Risk"})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:o.filter(n=>n.churnRisk==="medium").length}),e.jsx("div",{className:"text-sm text-yellow-700",children:"Medium Churn Risk"})]}),e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:o.filter(n=>n.churnRisk==="high").length}),e.jsx("div",{className:"text-sm text-red-700",children:"High Churn Risk"})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:["$",o.length>0?(o.reduce((n,l)=>n+l.lifetimeValue,0)/o.length).toFixed(2):"0.00"]}),e.jsx("div",{className:"text-sm text-blue-700",children:"Avg CLV"})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Customer Intelligence"}),e.jsxs("select",{value:t,onChange:n=>a(n.target.value),className:"px-3 py-2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"lifetimeValue",children:"Sort by Lifetime Value"}),e.jsx("option",{value:"churnRisk",children:"Sort by Churn Risk"}),e.jsx("option",{value:"totalBookings",children:"Sort by Total Bookings"})]})]}),e.jsx("div",{className:"space-y-4",children:s.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-4xl mb-4",children:"👥"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Customer Data"}),e.jsx("p",{className:"text-gray-600",children:"Customer insights will appear here once you have customer data."})]}):s.map(n=>e.jsxs("div",{className:"bg-white rounded-lg shadow border p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 text-lg",children:n.email}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600 mt-1",children:[e.jsxs("span",{children:[n.totalBookings," bookings"]}),e.jsxs("span",{children:["Last service: ",n.lastServiceDate]})]})]}),e.jsxs("span",{className:`px-3 py-1 text-sm rounded-full ${n.churnRisk==="low"?"bg-green-100 text-green-800":n.churnRisk==="medium"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[n.churnRisk," risk"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded",children:[e.jsxs("div",{className:"font-bold text-green-600",children:["$",n.lifetimeValue.toFixed(2)]}),e.jsx("div",{className:"text-xs text-green-700",children:"Lifetime Value"})]}),e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded",children:[e.jsxs("div",{className:"font-bold text-blue-600",children:["$",n.averageOrderValue.toFixed(2)]}),e.jsx("div",{className:"text-xs text-blue-700",children:"Avg Order Value"})]}),e.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded",children:[e.jsxs("div",{className:"font-bold text-purple-600",children:[n.satisfactionScore.toFixed(1),"/5"]}),e.jsx("div",{className:"text-xs text-purple-700",children:"Satisfaction"})]}),e.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded",children:[e.jsxs("div",{className:"font-bold text-orange-600",children:[n.referralPotential.toFixed(1),"/10"]}),e.jsx("div",{className:"text-xs text-orange-700",children:"Referral Score"})]})]}),n.recommendations.length>0&&e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-gray-900 mb-2",children:"Recommendations:"}),e.jsx("ul",{className:"text-sm text-gray-700 space-y-1",children:n.recommendations.map(l=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-blue-500 mr-2",children:"•"}),l]},`${n.id}-${l.substring(0,20)}`))})]})]},n.id))})]})},De=({bookings:o,onBookingUpdate:t,onDataRefresh:a})=>e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"p-6 border-b",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["All Bookings (",o.length,")"]})}),e.jsx("div",{className:"p-6",children:o.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"No bookings found."}):e.jsx("div",{className:"space-y-4",children:o.map(s=>e.jsx("div",{className:"border rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:s.bookingNumber}),e.jsx("p",{className:"text-sm text-gray-600",children:s.customerName}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.serviceDate," at ",s.serviceTime]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium",children:["$",s.amount.toFixed(2)]}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${s.status==="completed"?"bg-green-100 text-green-800":s.status==="scheduled"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:s.status})]})]})},s.id))})})]}),Be=({transactions:o,onRefund:t,onDataRefresh:a})=>e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"p-6 border-b",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["All Transactions (",o.length,")"]})}),e.jsx("div",{className:"p-6",children:o.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"No transactions found."}):e.jsx("div",{className:"space-y-4",children:o.map(s=>e.jsx("div",{className:"border rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:s.id}),e.jsx("p",{className:"text-sm text-gray-600",children:s.customerName}),e.jsx("p",{className:"text-sm text-gray-500",children:new Date(s.createdAt).toLocaleDateString()})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium",children:["$",s.amount.toFixed(2)]}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${s.status==="completed"?"bg-green-100 text-green-800":s.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:s.status})]})]})},s.id))})})]}),Ce=({customers:o})=>e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"p-6 border-b",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["All Customers (",o.length,")"]})}),e.jsx("div",{className:"p-6",children:o.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"No customers found."}):e.jsx("div",{className:"space-y-4",children:o.map(t=>e.jsx("div",{className:"border rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium",children:[t.firstName," ",t.lastName]}),e.jsx("p",{className:"text-sm text-gray-600",children:t.email}),e.jsx("p",{className:"text-sm text-gray-500",children:t.phone})]}),e.jsx("div",{className:"text-right",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${t.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.isActive?"Active":"Inactive"})})]})},t.id))})})]});export{Oe as default};
