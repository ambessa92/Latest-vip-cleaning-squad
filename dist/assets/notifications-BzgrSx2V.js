var d=Object.defineProperty;var f=(a,e,t)=>e in a?d(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var r=(a,e,t)=>f(a,typeof e!="symbol"?e+"":e,t);const n=class n{constructor(){r(this,"listeners",[])}static getInstance(){return n.instance||(n.instance=new n),n.instance}getNotifications(e){try{const t=localStorage.getItem(`vip_notifications_${e}`);return(t?JSON.parse(t):[]).sort((o,s)=>new Date(s.timestamp).getTime()-new Date(o.timestamp).getTime())}catch{return[]}}addNotification(e){const t={...e,id:`notif_${Date.now()}_${Math.random().toString(36).substring(2)}`,timestamp:new Date().toISOString(),read:!1};if(e.customerId){const i=this.getNotifications(e.customerId),o=[t,...i];localStorage.setItem(`vip_notifications_${e.customerId}`,JSON.stringify(o)),this.showBrowserNotification(t),this.notifyListeners(e.customerId,o)}return t}markAsRead(e,t){const o=this.getNotifications(e).map(s=>s.id===t?{...s,read:!0}:s);localStorage.setItem(`vip_notifications_${e}`,JSON.stringify(o)),this.notifyListeners(e,o)}markAllAsRead(e){const i=this.getNotifications(e).map(o=>({...o,read:!0}));localStorage.setItem(`vip_notifications_${e}`,JSON.stringify(i)),this.notifyListeners(e,i)}deleteNotification(e,t){const o=this.getNotifications(e).filter(s=>s.id!==t);localStorage.setItem(`vip_notifications_${e}`,JSON.stringify(o)),this.notifyListeners(e,o)}getUnreadCount(e){return this.getNotifications(e).filter(i=>!i.read).length}subscribe(e,t){return this.listeners.push(t),t(this.getNotifications(e)),()=>{this.listeners=this.listeners.filter(i=>i!==t)}}notifyListeners(e,t){for(const i of this.listeners)i(t)}showBrowserNotification(e){if("Notification"in window&&Notification.permission==="granted"){const t=new Notification(e.title,{body:e.message,icon:"/favicon.ico",badge:"/favicon.ico",tag:e.id});t.onclick=()=>{window.focus(),e.actionUrl&&(window.location.href=e.actionUrl)},setTimeout(()=>t.close(),5e3)}}async requestPermission(){return"Notification"in window?await Notification.requestPermission()==="granted":!1}static createBookingConfirmation(e,t,i){return n.getInstance().addNotification({type:"booking_confirmed",title:"Booking Confirmed! üéâ",message:`Your cleaning service (${t}) has been confirmed for ${new Date(i).toLocaleDateString()}.`,customerId:e,relatedBookingId:t,priority:"high",actionUrl:"/?page=dashboard",actionText:"View Booking"})}static createPaymentConfirmation(e,t,i){return n.getInstance().addNotification({type:"payment_received",title:"Payment Received ‚úÖ",message:`Your payment of $${t.toFixed(2)} has been successfully processed. Transaction ID: ${i}`,customerId:e,priority:"medium",actionUrl:"/?page=dashboard",actionText:"View Payment"})}static createServiceReminder(e,t,i,o){return n.getInstance().addNotification({type:"service_reminder",title:"Service Reminder üïê",message:`Your cleaning service (${t}) is scheduled in ${o} hours on ${new Date(i).toLocaleDateString()}.`,customerId:e,relatedBookingId:t,priority:"medium",actionUrl:"/?page=dashboard",actionText:"View Details"})}static createServiceStarted(e,t,i){return n.getInstance().addNotification({type:"service_started",title:"Service Started üßπ",message:`${i} has started your cleaning service (${t}). Estimated completion in 2-3 hours.`,customerId:e,relatedBookingId:t,priority:"high",actionUrl:"/?page=dashboard",actionText:"Track Progress"})}static createServiceCompleted(e,t,i){return n.getInstance().addNotification({type:"service_completed",title:"Service Completed! ‚ú®",message:`${i} has completed your cleaning service (${t}). We hope you love your clean space!`,customerId:e,relatedBookingId:t,priority:"high",actionUrl:"/?page=dashboard",actionText:"Rate Service"})}static createWelcomeNotification(e,t){return n.getInstance().addNotification({type:"info",title:`Welcome to VIP Cleaning Squad, ${t}! üëã`,message:"Thank you for joining us! Your account is ready. Book your first cleaning service today.",customerId:e,priority:"medium",actionUrl:"/",actionText:"Book Service"})}};r(n,"instance");let c=n;export{c as NotificationService,c as default};
